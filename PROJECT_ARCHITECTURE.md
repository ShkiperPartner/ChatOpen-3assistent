# Project Architecture & Roadmap

**–ü—Ä–æ–µ–∫—Ç:** ChatOpenAI Integration Assistant
**–¶–µ–ª—å:** AI Partnership Operating System
**–¢–µ–∫—É—â–∞—è Phase:** 1 ‚Üí 2 (Transition)
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-01-31

---

## üéØ Meta-Goal (–∏–∑ VISION.md)

> –≠—Ç–æ –Ω–µ "–µ—â–µ –æ–¥–∏–Ω ChatGPT wrapper"
> –≠—Ç–æ –û–ü–ï–†–ê–¶–ò–û–ù–ù–ê–Ø –°–ò–°–¢–ï–ú–ê –¥–ª—è AI Partnership

**North Star:**
- Knowledge Accumulation (–∑–Ω–∞–Ω–∏—è –Ω–µ —Ç–µ—Ä—è—é—Ç—Å—è)
- Context Continuity (–ø–∞–º—è—Ç—å –º–µ–∂–¥—É —Å–µ—Å—Å–∏—è–º–∏)
- Shared Intelligence (AI –¥–µ–ª—è—Ç—Å—è –∑–Ω–∞–Ω–∏—è–º–∏)
- Autonomous Partnership (–ø—Ä–æ–∞–∫—Ç–∏–≤–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫)

---

## üìä –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã

### ‚úÖ Phase 1: Foundation (95% –∑–∞–≤–µ—Ä—à–µ–Ω–æ)

**–ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- ‚úÖ –ë–∞–∑–æ–≤—ã–π —á–∞—Ç —Å OpenAI Assistants API
- ‚úÖ Multi-personality system (—Ä–∞–∑–Ω—ã–µ AI –ø–æ–º–æ—â–Ω–∏–∫–∏)
- ‚úÖ Persistent chat history (Supabase)
- ‚úÖ File attachments —á–µ—Ä–µ–∑ OpenAI Files API
- ‚úÖ Zustand state management
- ‚úÖ RLS security policies

**–í –ø—Ä–æ—Ü–µ—Å—Å–µ:**
- üîÑ File upload UI –¥–ª—è personalities
- üîÑ –°—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è –±–∞–∑–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

**–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
```
src/
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ Chat.tsx              # –û—Å–Ω–æ–≤–Ω–æ–π UI —á–∞—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ Personalities.tsx     # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ AI –ø–æ–º–æ—â–Ω–∏–∫–∞–º–∏
‚îÇ   ‚îî‚îÄ‚îÄ Settings.tsx          # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚îú‚îÄ‚îÄ store/
‚îÇ   ‚îî‚îÄ‚îÄ useStore.ts           # Zustand store (—Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ)
‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îú‚îÄ‚îÄ openai.ts             # OpenAI API service
‚îÇ   ‚îî‚îÄ‚îÄ supabase.ts           # Supabase client + —Ç–∏–ø—ã
‚îî‚îÄ‚îÄ api/
    ‚îî‚îÄ‚îÄ (–±—É–¥—É—â–∏–π Memory Service)
```

---

## üß† –ö–ª—é—á–µ–≤–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ —Å–µ—Å—Å–∏–∏: –¢—Ä–∏ —Ç–∏–ø–∞ –ø–∞–º—è—Ç–∏

**–î–∞—Ç–∞:** 2025-01-31
**–ò–Ω—Å–∞–π—Ç:** –°–∏—Å—Ç–µ–º–∞ —É–∂–µ –∏–º–µ–µ—Ç –¢–†–ò —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–∞ –ø–∞–º—è—Ç–∏!

### –ö–æ–Ω—Ü–µ–ø—Ü–∏—è —Ç—Ä—ë—Ö —Ç–∏–ø–æ–≤ –ø–∞–º—è—Ç–∏:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  –¢—Ä–∏ —Ç–∏–ø–∞ –ø–∞–º—è—Ç–∏ –¥–ª—è AI-–ø–æ–º–æ—â–Ω–∏–∫–∞           ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                             ‚îÇ
‚îÇ  üìö –ë–ò–ë–õ–ò–û–¢–ï–ö–ê (document_chunks)            ‚îÇ
‚îÇ     –ì–ª–æ–±–∞–ª—å–Ω–∞—è –±–∞–∑–∞ –∑–Ω–∞–Ω–∏–π                  ‚îÇ
‚îÇ     –ü—É–±–ª–∏—á–Ω—ã–µ + –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã         ‚îÇ
‚îÇ     –í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ –≤—Å–µ–º —Ñ–∞–π–ª–∞–º          ‚îÇ
‚îÇ                                             ‚îÇ
‚îÇ  üíº –†–ê–ë–û–ß–ò–ô –°–¢–û–õ (personality_embeddings)   ‚îÇ
‚îÇ     –§–∞–π–ª—ã –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–º–æ—â–Ω–∏–∫–∞         ‚îÇ
‚îÇ     –ö–∞–∂–¥—ã–π personality –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏    ‚îÇ
‚îÇ     –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è           ‚îÇ
‚îÇ                                             ‚îÇ
‚îÇ  üìì –î–ù–ï–í–ù–ò–ö (MaaS tables)                   ‚îÇ
‚îÇ     –ü–∞–º—è—Ç—å –æ —Ä–∞–∑–≥–æ–≤–æ—Ä–∞—Ö                     ‚îÇ
‚îÇ     Facts, decisions, summaries             ‚îÇ
‚îÇ     –ö–æ–Ω—Ç–µ–∫—Å—Ç –º–µ–∂–¥—É —Å–µ—Å—Å–∏—è–º–∏                 ‚îÇ
‚îÇ                                             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ê–Ω–∞–ª–æ–≥–∏—è (–¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è):

| –¢–∏–ø –ø–∞–º—è—Ç–∏ | –ê–Ω–∞–ª–æ–≥–∏—è | –ü—Ä–∏–º–µ—Ä |
|------------|----------|---------|
| üìö –ë–ò–ë–õ–ò–û–¢–ï–ö–ê | –û—Ñ–∏—Å–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ | "–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ React", "Material Design Guide" |
| üíº –†–ê–ë–û–ß–ò–ô –°–¢–û–õ | –õ–∏—á–Ω—ã–π —Å—Ç–æ–ª —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ | –î–∏–∑–∞–π–Ω–µ—Ä –≤–∏–¥–∏—Ç —Ñ–∞–π–ª—ã –¥–∏–∑–∞–π–Ω–∞, –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç - –∫–æ–¥ |
| üìì –î–ù–ï–í–ù–ò–ö | –ë–ª–æ–∫–Ω–æ—Ç –æ –∫–ª–∏–µ–Ω—Ç–µ | "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ª—é–±–∏—Ç —Ç—ë–º–Ω—É—é —Ç–µ–º—É", "–†–µ—à–∏–ª–∏ –Ω–∞—á–∞—Ç—å —Å iOS" |

---

## üö® –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞: –†–∞–∑–¥–µ–ª—ë–Ω–Ω—ã–µ –ë–î

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–æ:** 2025-01-31

### –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:

```
Supabase –ü—Ä–æ–µ–∫—Ç –ê: "ChatApp"
‚îú‚îÄ‚îÄ personalities ‚úÖ
‚îú‚îÄ‚îÄ personality_embeddings ‚úÖ
‚îú‚îÄ‚îÄ chats ‚úÖ
‚îú‚îÄ‚îÄ messages ‚úÖ
‚îî‚îÄ‚îÄ document_chunks ‚ùå (–ù–ï –°–û–ó–î–ê–ù–ê)

Supabase –ü—Ä–æ–µ–∫—Ç –ë: "MaaS"
‚îú‚îÄ‚îÄ projects ‚úÖ
‚îú‚îÄ‚îÄ facts ‚úÖ
‚îú‚îÄ‚îÄ thread_summaries ‚úÖ
‚îú‚îÄ‚îÄ decisions ‚úÖ
‚îú‚îÄ‚îÄ links ‚úÖ
‚îú‚îÄ‚îÄ sources ‚úÖ
‚îú‚îÄ‚îÄ maas_metrics ‚úÖ
‚îî‚îÄ‚îÄ snapshot_cache ‚úÖ
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- ‚ùå –ù–µ–ª—å–∑—è –¥–µ–ª–∞—Ç—å JOIN –º–µ–∂–¥—É –ø—Ä–æ–µ–∫—Ç–∞–º–∏
- ‚ùå –ù–µ—Ç foreign keys –º–µ–∂–¥—É –±–∞–∑–∞–º–∏
- ‚ùå –°–ª–æ–∂–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å HTTP –∑–∞–ø—Ä–æ—Å–∞–º–∏

**–†–µ—à–µ–Ω–∏–µ:**
‚úÖ **–ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å MaaS –≤ –ü—Ä–æ–µ–∫—Ç –ê** ‚Üí –ï–¥–∏–Ω–∞—è –ë–î!

---

## üöÄ Unified Memory System (Phase 2)

### –¶–µ–ª—å: –û–±—ä–µ–¥–∏–Ω–∏—Ç—å –≤—Å–µ —Ç—Ä–∏ —Ç–∏–ø–∞ –ø–∞–º—è—Ç–∏ –≤ –æ–¥–Ω—É –ë–î

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏:**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Supabase –ü—Ä–æ–µ–∫—Ç –ê: "ChatApp"                ‚îÇ
‚îÇ  (–ï–¥–∏–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö)                        ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                              ‚îÇ
‚îÇ  üì± –ß–ê–¢-–ü–†–ò–õ–û–ñ–ï–ù–ò–ï                           ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ chats                                   ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ messages                                ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ personalities                           ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ user_settings                           ‚îÇ
‚îÇ                                              ‚îÇ
‚îÇ  üíº –†–ê–ë–û–ß–ò–ô –°–¢–û–õ                             ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ personality_embeddings ‚úÖ               ‚îÇ
‚îÇ                                              ‚îÇ
‚îÇ  üìö –ë–ò–ë–õ–ò–û–¢–ï–ö–ê                               ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ document_chunks üî® –°–û–ó–î–ê–¢–¨              ‚îÇ
‚îÇ                                              ‚îÇ
‚îÇ  üìì –î–ù–ï–í–ù–ò–ö (MaaS)                           ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ projects üîÑ –ú–ò–ì–†–ò–†–û–í–ê–¢–¨                 ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ facts üîÑ                                ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ thread_summaries üîÑ                     ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ decisions üîÑ                            ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ links üîÑ                                ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ sources üîÑ                              ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ maas_metrics üîÑ                         ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ snapshot_cache üîÑ                       ‚îÇ
‚îÇ                                              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üìã Roadmap: Phase 1 ‚Üí Phase 2

### üü¢ Sprint 1: –ú–∏–≥—Ä–∞—Ü–∏—è MaaS (1 –Ω–µ–¥–µ–ª—è)

**–ó–∞–¥–∞—á–∏:**
- [ ] –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –∏–∑ –ü—Ä–æ–µ–∫—Ç–∞ –ë (–µ—Å–ª–∏ –µ—Å—Ç—å)
- [ ] –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é MaaS tables –≤ –ü—Ä–æ–µ–∫—Ç –ê
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
- [ ] –û–±–Ω–æ–≤–∏—Ç—å TypeScript —Ç–∏–ø—ã

**–ú–∏–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª:** `supabase/migrations/20250229000000_unified_memory_system.sql`

**Deliverable:** üìì –î–ù–ï–í–ù–ò–ö –≤ –µ–¥–∏–Ω–æ–π –ë–î

---

### üü° Sprint 2: –°–æ–∑–¥–∞—Ç—å document_chunks (1 –Ω–µ–¥–µ–ª—è)

**–ó–∞–¥–∞—á–∏:**
- [ ] –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É document_chunks
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≥–∏–±—Ä–∏–¥–Ω—ã–π –¥–æ—Å—Ç—É–ø (–ø—É–±–ª–∏—á–Ω—ã–µ + –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ)
- [ ] SQL —Ñ—É–Ω–∫—Ü–∏—è `search_document_chunks()`
- [ ] –í–µ–∫—Ç–æ—Ä–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã (ivfflat)
- [ ] RLS –ø–æ–ª–∏—Ç–∏–∫–∏

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ document_chunks:**
```sql
document_chunks {
  id: UUID
  user_id: UUID          -- NULL = –ø—É–±–ª–∏—á–Ω—ã–π
  is_public: BOOLEAN     -- true = –≤—Å–µ –≤–∏–¥—è—Ç
  project_id: UUID       -- —Å–≤—è–∑—å —Å MaaS projects

  content: TEXT
  embedding: VECTOR(1536)

  file_name: TEXT
  file_type: TEXT
  metadata: JSONB
}
```

**Deliverable:** üìö –ë–ò–ë–õ–ò–û–¢–ï–ö–ê –≥–æ—Ç–æ–≤–∞

---

### üîµ Sprint 3: Memory Service API (1-2 –Ω–µ–¥–µ–ª–∏)

**–ó–∞–¥–∞—á–∏:**
- [ ] –°–æ–∑–¥–∞—Ç—å `src/api/memory-service.ts`
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `searchMemory()` —Å —Ç—Ä–µ–º—è –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏
- [ ] –í–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è query —á–µ—Ä–µ–∑ OpenAI embeddings
- [ ] –†–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ relevance
- [ ] Unit —Ç–µ—Å—Ç—ã

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Memory Service:**

```
Memory Service API
‚îú‚îÄ‚îÄ searchMemory(query, user_id, personality_id, project_id)
    ‚îú‚îÄ‚îÄ searchLibrary()     üìö document_chunks
    ‚îú‚îÄ‚îÄ searchDesk()        üíº personality_embeddings
    ‚îî‚îÄ‚îÄ searchDiary()       üìì MaaS facts

    ‚Üí –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    ‚Üí –†–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ relevance
    ‚Üí –í–æ–∑–≤—Ä–∞—Ç unified context
```

**Deliverable:** üîÑ API –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç —Ç—Ä–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞

---

### üü£ Sprint 4: UI Components (1-2 –Ω–µ–¥–µ–ª–∏)

**–ó–∞–¥–∞—á–∏:**
- [ ] `MemoryLibrary.tsx` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π
- [ ] `MemoryDiary.tsx` - –ø—Ä–æ—Å–º–æ—Ç—Ä facts/decisions
- [ ] `MemoryExplorer.tsx` - –æ–±—â–∏–π UI –¥–ª—è –ø–∞–º—è—Ç–∏
- [ ] –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –≤ —á–∞—Ç–µ ([üìö], [üíº], [üìì])

**UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
```
src/components/
‚îú‚îÄ‚îÄ memory/
‚îÇ   ‚îú‚îÄ‚îÄ MemoryLibrary.tsx      üìö –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ MemoryDiary.tsx        üìì –î–Ω–µ–≤–Ω–∏–∫
‚îÇ   ‚îú‚îÄ‚îÄ MemoryExplorer.tsx     üîç –û–±–∑–æ—Ä –ø–∞–º—è—Ç–∏
‚îÇ   ‚îî‚îÄ‚îÄ MemorySourceBadge.tsx  üè∑Ô∏è Badges –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
```

**Deliverable:** üé® UI –¥–ª—è —Ç—Ä—ë—Ö —Ç–∏–ø–æ–≤ –ø–∞–º—è—Ç–∏

---

### üéØ Sprint 5: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ —á–∞—Ç (1 –Ω–µ–¥–µ–ª—è)

**–ó–∞–¥–∞—á–∏:**
- [ ] –û–±–Ω–æ–≤–∏—Ç—å `useStore.sendMessage()` —Å Memory Service
- [ ] Enriched context –¥–ª—è AI (–±–∏–±–ª–∏–æ—Ç–µ–∫–∞ + —Å—Ç–æ–ª + –¥–Ω–µ–≤–Ω–∏–∫)
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —ç–∫—Å—Ç—Ä–∞–∫—Ü–∏—è facts –∏–∑ –æ—Ç–≤–µ—Ç–æ–≤
- [ ] –ù–∞—Å—Ç—Ä–æ–π–∫–∏ memory (–≤–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫–∏)

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**
```typescript
// src/store/useStore.ts
sendMessage: async (content: string) => {
  // 1. –ü–æ–ª—É—á–∏—Ç—å unified context
  const memoryContext = await searchMemory({
    query: content,
    user_id: userId,
    personality_id: activePersonality.id,
    project_id: currentProjectId,
  });

  // 2. –û–±–æ–≥–∞—Ç–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
  const enrichedMessage = `
    ${content}

    [Context from memory:]
    üìö ${libraryContext}
    üíº ${deskContext}
    üìì ${diaryContext}
  `;

  // 3. –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ OpenAI
  await openaiService.sendMessage(enrichedMessage);

  // 4. –ê–≤—Ç–æ—ç–∫—Å—Ç—Ä–∞–∫—Ü–∏—è facts (Phase 2+)
  await extractFacts(response);
}
```

**Deliverable:** ‚úÖ **Phase 2 COMPLETE!**

---

## üéØ Phase 2 Completion Criteria

**Phase 2 —Å—á–∏—Ç–∞–µ—Ç—Å—è –∑–∞–≤–µ—Ä—à—ë–Ω–Ω–æ–π –∫–æ–≥–¥–∞:**

- ‚úÖ –í—Å–µ —Ç—Ä–∏ —Ç–∏–ø–∞ –ø–∞–º—è—Ç–∏ –≤ –æ–¥–Ω–æ–π –ë–î
- ‚úÖ Memory Service API —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ AI –≤–∏–¥–∏—Ç unified context –ø—Ä–∏ –æ—Ç–≤–µ—Ç–µ
- ‚úÖ UI –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–º—è—Ç—å—é
- ‚úÖ –ê–≤—Ç–æ—ç–∫—Å—Ç—Ä–∞–∫—Ü–∏—è facts –∏–∑ —Ä–∞–∑–≥–æ–≤–æ—Ä–æ–≤
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç:
  - –ó–∞–≥—Ä—É–∂–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫—É (–ø—É–±–ª–∏—á–Ω—ã–µ/–ø—Ä–∏–≤–∞—Ç–Ω—ã–µ)
  - –ü—Ä–∏–∫—Ä–µ–ø–ª—è—Ç—å —Ñ–∞–π–ª—ã –∫ personalities (—Ä–∞–±–æ—á–∏–π —Å—Ç–æ–ª)
  - –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å facts/decisions –∏–∑ —Ä–∞–∑–≥–æ–≤–æ—Ä–æ–≤ (–¥–Ω–µ–≤–Ω–∏–∫)
  - AI –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—Å–µ —Ç—Ä–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞

**–ú–µ—Ç—Ä–∏–∫–∞ —É—Å–ø–µ—Ö–∞:**
AI –ø–æ–º–æ—â–Ω–∏–∫ –æ—Ç–≤–µ—á–∞–µ—Ç —Å —É—á—ë—Ç–æ–º:
- –î–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
- –§–∞–π–ª–æ–≤ personality
- –§–∞–∫—Ç–æ–≤ –∏–∑ –ø—Ä–æ—à–ª—ã—Ö —Ä–∞–∑–≥–æ–≤–æ—Ä–æ–≤

‚Üí **Context Continuity –º–µ–∂–¥—É —Å–µ—Å—Å–∏—è–º–∏!**

---

## üèóÔ∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### Database Schema (–ø–æ—Å–ª–µ —É–Ω–∏—Ñ–∏–∫–∞—Ü–∏–∏)

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã (13 —à—Ç):**

```sql
-- –ß–ê–¢-–ü–†–ò–õ–û–ñ–ï–ù–ò–ï (4)
chats                      -- —Ä–∞–∑–≥–æ–≤–æ—Ä—ã
messages                   -- —Å–æ–æ–±—â–µ–Ω–∏—è
personalities              -- AI –ø–æ–º–æ—â–Ω–∏–∫–∏
user_settings              -- –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

-- –ü–ê–ú–Ø–¢–¨: –†–ê–ë–û–ß–ò–ô –°–¢–û–õ (1)
personality_embeddings     -- —Ñ–∞–π–ª—ã –¥–ª—è personalities

-- –ü–ê–ú–Ø–¢–¨: –ë–ò–ë–õ–ò–û–¢–ï–ö–ê (1)
document_chunks            -- –≥–ª–æ–±–∞–ª—å–Ω–∞—è –±–∞–∑–∞ –∑–Ω–∞–Ω–∏–π

-- –ü–ê–ú–Ø–¢–¨: –î–ù–ï–í–ù–ò–ö (8)
projects                   -- MaaS –ø—Ä–æ–µ–∫—Ç—ã
facts                      -- —Ñ–∞–∫—Ç—ã –∏–∑ —Ä–∞–∑–≥–æ–≤–æ—Ä–æ–≤
thread_summaries           -- —Å–∞–º–º–∞—Ä–∏ —Ç—Ä–µ–¥–æ–≤
decisions                  -- —Ä–µ—à–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
links                      -- —Å–≤—è–∑–∏ –º–µ–∂–¥—É —Å—É—â–Ω–æ—Å—Ç—è–º–∏
sources                    -- –≤–Ω–µ—à–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏
maas_metrics               -- –º–µ—Ç—Ä–∏–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
snapshot_cache             -- –∫–µ—à —Å–Ω–∞–ø—à–æ—Ç–æ–≤
```

### –í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫

**–¢—Ä–∏ SQL —Ñ—É–Ω–∫—Ü–∏–∏:**
```sql
-- üìö –ü–æ–∏—Å–∫ –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ
search_document_chunks(
  query_embedding VECTOR(1536),
  user_id UUID,
  project_id UUID
) ‚Üí —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —á–∞–Ω–∫–∏

-- üíº –ü–æ–∏—Å–∫ –Ω–∞ —Ä–∞–±–æ—á–µ–º —Å—Ç–æ–ª–µ
search_personality_embeddings(
  query_embedding VECTOR(1536),
  personality_id UUID
) ‚Üí —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —á–∞–Ω–∫–∏ –¥–ª—è personality

-- üìì –ü–æ–∏—Å–∫ –≤ –¥–Ω–µ–≤–Ω–∏–∫–µ
-- (—á–µ—Ä–µ–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ Supabase queries –ø–æ facts)
```

### API Endpoints (–ø–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ)

```
GET  /api/memory/context
POST /api/memory/search
POST /api/memory/library/upload
POST /api/memory/facts/extract
GET  /api/memory/diary/{project_id}
```

---

## üîÆ Phase 3-4 (–±—É–¥—É—â–µ–µ)

### Phase 3: Cross-Assistant Memory

**–¶–µ–ª—å:** Shared intelligence –º–µ–∂–¥—É AI –ø–æ–º–æ—â–Ω–∏–∫–∞–º–∏

- Shared memory pool
- Knowledge transfer –º–µ–∂–¥—É assistants
- Context handoff (–ø–µ—Ä–µ–¥–∞—á–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞)
- AI ‚Üî AI collaborative discussions

### Phase 4: Autonomous Collaboration

**–¶–µ–ª—å:** –ü—Ä–æ–∞–∫—Ç–∏–≤–Ω—ã–π AI –ø–∞—Ä—Ç–Ω–µ—Ä

- Proactive insights (AI —Å–∞–º –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –∏–¥–µ–∏)
- Progress tracking & reminders
- Conflict detection (–ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏—è –≤ –ø–ª–∞–Ω–∞—Ö)
- Trend analysis (—á—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç, —á—Ç–æ –Ω–µ—Ç)
- Autonomous task breakdown

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞

### –¢–µ–∫—É—â–∏–µ –º–µ—Ç—Ä–∏–∫–∏:

- **Phase 1 Progress:** 95%
- **Code Coverage:** N/A (–Ω—É–∂–Ω—ã —Ç–µ—Å—Ç—ã)
- **Database Tables:** 5 (—á–∞—Ç) + 1 (—Ä–∞–±–æ—á–∏–π —Å—Ç–æ–ª) = 6
- **–ü–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏:** 6 + 8 (–¥–Ω–µ–≤–Ω–∏–∫) + 1 (–±–∏–±–ª–∏–æ—Ç–µ–∫–∞) = 15 —Ç–∞–±–ª–∏—Ü

### North Star Metrics (–∏–∑ VISION.md):

- ‚úÖ Knowledge Accumulation: 60% (–µ—Å—Ç—å persistence, –Ω–µ—Ç —É–Ω–∏—Ñ–∏–∫–∞—Ü–∏–∏)
- üîÑ Context Continuity: 40% (–±–∞–∑–æ–≤–∞—è –∏—Å—Ç–æ—Ä–∏—è, –Ω–µ—Ç –ø–∞–º—è—Ç–∏ –º–µ–∂–¥—É —Ç–∏–ø–∞–º–∏)
- ‚ùå Shared Intelligence: 0% (–Ω–µ—Ç –∫—Ä–æ—Å—Å-assistant memory)
- ‚ùå Autonomous Partnership: 0% (–Ω–µ—Ç –ø—Ä–æ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏)

**–ü–æ—Å–ª–µ Phase 2:**
- ‚úÖ Knowledge Accumulation: 90%
- ‚úÖ Context Continuity: 85%
- üîÑ Shared Intelligence: 30%
- üîÑ Autonomous Partnership: 20%

---

## üîß Tech Stack

**Frontend:**
- React + TypeScript
- Zustand (state management)
- Tailwind CSS

**Backend:**
- Supabase (PostgreSQL + Auth + Storage)
- OpenAI Assistants API
- pgvector (–≤–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫)

**AI/ML:**
- OpenAI GPT-4
- text-embedding-3-small (1536 dimensions)

**DevOps:**
- Git + GitHub
- Supabase CLI
- Node.js scripts –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–π

---

## üìù –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è:

1. **–§–∞–π–ª—ã –≤ OpenAI, –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –≤ –ë–î**
   - –†–µ–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã ‚Üí OpenAI Files API
   - –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ ‚Üí personalities.files (JSONB)
   - –í–µ–∫—Ç–æ—Ä—ã ‚Üí personality_embeddings / document_chunks

2. **–ì–∏–±—Ä–∏–¥–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ**
   - `user_id = NULL && is_public = true` ‚Üí –ø—É–±–ª–∏—á–Ω—ã–µ
   - `user_id = X && is_public = false` ‚Üí –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ
   - `user_id = X && is_public = true` ‚Üí —Å–æ–∑–¥–∞–Ω—ã user, –Ω–æ –≤—Å–µ –≤–∏–¥—è—Ç

3. **MaaS –∫–∞–∫ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å**
   - –û—Ç–¥–µ–ª—å–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã, –Ω–æ –≤ —Ç–æ–π –∂–µ –ë–î
   - –°–≤—è–∑—å —á–µ—Ä–µ–∑ project_id
   - –ú–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä—è—Ç—å –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ

### –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:

- OpenAI API rate limits
- pgvector —Å–ø–∏—Å–∫–∏=100 (–¥–ª—è <1M vectors)
- Supabase free tier –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
- RLS overhead –Ω–∞ –±–æ–ª—å—à–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–∞—Ö

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–ª–≥:

- [ ] –ù–µ—Ç unit —Ç–µ—Å—Ç–æ–≤
- [ ] –ù–µ—Ç error boundaries –≤ React
- [ ] Bundle size –Ω–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω
- [ ] –ù–µ—Ç code splitting

---

## üéì Lessons Learned (—Å–µ—Å—Å–∏—è 2025-01-31)

### –ö–ª—é—á–µ–≤—ã–µ –∏–Ω—Å–∞–π—Ç—ã:

1. **Ritual-First –ø–æ–¥—Ö–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç**
   - –ù–∞—á–∞–ª–∏ —Å VISION.md ‚Üí –ø–æ–Ω—è–ª–∏ big picture
   - –í—Å–µ —Ä–µ—à–µ–Ω–∏—è aligned —Å meta-goal

2. **–ö–æ–Ω—Ü–µ–ø—Ü–∏—è —Ç—Ä—ë—Ö —Ç–∏–ø–æ–≤ –ø–∞–º—è—Ç–∏**
   - –ü—Ä–æ—Å—Ç–∞—è –∞–Ω–∞–ª–æ–≥–∏—è –ø–æ–º–æ–≥–ª–∞ –ø–æ–Ω—è—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É
   - –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞/–°—Ç–æ–ª/–î–Ω–µ–≤–Ω–∏–∫ ‚Üí –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ –ø–æ–Ω—è—Ç–Ω–æ

3. **–†–∞–∑–¥–µ–ª—ë–Ω–Ω—ã–µ –ë–î ‚Üí –ø—Ä–æ–±–ª–µ–º–∞**
   - –û–±–Ω–∞—Ä—É–∂–∏–ª–∏ –∫—Ä–∏—Ç–∏—á–Ω—É—é –ø—Ä–æ–±–ª–µ–º—É —Ä–∞–Ω–æ
   - –†–µ—à–µ–Ω–∏–µ: –º–∏–≥—Ä–∞—Ü–∏—è –≤ –µ–¥–∏–Ω—É—é –ë–î

4. **Unified Memory System = Phase 2**
   - MaaS —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (infrastructure –≥–æ—Ç–æ–≤–∞!)
   - –ù—É–∂–Ω–∞ —Ç–æ–ª—å–∫–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è ‚Üí –±—ã—Å—Ç—Ä—ã–π ROI

### –ß—Ç–æ –Ω–µ –¥–µ–ª–∞—Ç—å:

- ‚ùå –ù–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å feature –±–µ–∑ –ø–æ–Ω–∏–º–∞–Ω–∏—è meta-goal
- ‚ùå –ù–µ —Ä–∞–∑–¥–µ–ª—è—Ç—å —Å–≤—è–∑–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ —Ä–∞–∑–Ω—ã–º –ë–î
- ‚ùå –ù–µ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å VISION.md –ø—Ä–∏ –ø—Ä–∏–Ω—è—Ç–∏–∏ —Ä–µ—à–µ–Ω–∏–π

---

## üìö –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- `VISION.md` - Meta-goal –∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è (–ß–ò–¢–ê–¢–¨ –ü–ï–†–í–´–ú!)
- `CLAUDE.md` - –†–∞–±–æ—á–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- `DATABASE_CHANGELOG.md` - –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –ë–î
- `README.md` - –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ–µ–∫—Ç–µ

---

*–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: 2025-01-31*
*–°–ª–µ–¥—É—é—â–∏–π review: –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è Phase 2*
*Maintainer: Development Team*
